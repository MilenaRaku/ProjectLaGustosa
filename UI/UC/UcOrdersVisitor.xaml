<UserControl x:Class="LaGustosa.UI.UC.UcOrdersVisitor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:LaGustosa.UI.UC"
             mc:Ignorable="d" 
             Height="800" Width="1150">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="110"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,10">
            <Canvas>
                <Line Canvas.Top="48" Style="{StaticResource Line}"/>
            </Canvas>
        </Grid>

        <Border Grid.Row="0" Padding="15">
            <Grid >
                <TextBlock Text="Заказы" Style="{StaticResource TbUserControl}" VerticalAlignment="Top" Margin="0,-3,0,0"/>

                <TextBlock Text="Статус готовности заказа: " Style="{StaticResource Foreground}" FontSize="23"  HorizontalAlignment="Right" Margin="0,55,283,-15"/>
                <ComboBox  x:Name="CombBoxStatus" SelectionChanged="CombBoxStatus_SelectionChanged" DisplayMemberPath="Status" FontSize="15"  Width="250" Height="35" HorizontalAlignment="Right" Margin="0,45,10,0"/>
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" Margin="10">
            <ItemsControl x:Name="OrdersList">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Margin="0,0,0,20"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource BorderOrder}" Margin="0,0,0,15">
                            <Grid Margin="10">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                    <TextBlock Text="Заказ №" FontSize="20" Style="{StaticResource TbOrder}"/>
                                    <TextBlock Text="{Binding Number}" FontSize="20" Style="{StaticResource TbOrder}"/>
                                    <TextBlock Text=", Стол №" FontSize="20" Style="{StaticResource TbOrder}" Margin="20,0,0,0"/>
                                    <TextBlock Text="{Binding Tables.Number}" FontSize="20" Style="{StaticResource TbOrder}"/>
                                </StackPanel>

                                <!-- Статус заказа -->
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                                    <TextBlock Text="Статус: " Style="{StaticResource TbOrder}" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding KitchenStatus.Status}" Style="{StaticResource TbOrder}"/>
                                </StackPanel>

                                <!-- Список блюд -->
                                <StackPanel Grid.Row="2" Margin="0,15,0,15">
                                    <TextBlock Text="Состав заказа:" Style="{StaticResource TbOrder}" Margin="0,0,0,5"/>
                                    <ItemsControl ItemsSource="{Binding OrderComposition}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                                    <TextBlock Text="{Binding Dish.Name}" Style="{StaticResource TbOrder}" 
                                                              Width="250" TextWrapping="Wrap"/>
                                                    <TextBlock Text="{Binding NumberPositions, StringFormat=' ×{0}'}" 
                                                              Style="{StaticResource TbOrder}" Width="40" TextAlignment="Center"/>
                                                    <TextBlock Text="{Binding Dish.Price, StringFormat=' {0:# руб.}'}" 
                                                              Style="{StaticResource TbOrder}" Width="100"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>

                                <!-- Общая сумма -->
                                <StackPanel Grid.Row="3" Orientation="Horizontal">
                                    <TextBlock Text="Итого: " Style="{StaticResource TbOrder}" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding Amount, StringFormat={}{0:#.## руб.}}" Style="{StaticResource TbOrder}" FontWeight="Bold"/>
                                </StackPanel>

                                <!-- Время создания -->
                                <StackPanel Grid.Row="4" Orientation="Horizontal" Margin="0,10,0,0">
                                    <TextBlock Text="Создан: " Style="{StaticResource TbOrder}"/>
                                    <TextBlock Text="{Binding OrderOpenings, StringFormat=' {0:dd.MM.yyyy HH:mm}'}" Style="{StaticResource TbOrder}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Сообщение, если заказов нет -->
        <TextBlock x:Name="NoOrdersText" Grid.Row="1" Text="Нет активных заказов" 
                  Style="{StaticResource TbOrder}" FontSize="24" HorizontalAlignment="Center" 
                  VerticalAlignment="Center" Visibility="Collapsed"/>

    </Grid>
</UserControl>
